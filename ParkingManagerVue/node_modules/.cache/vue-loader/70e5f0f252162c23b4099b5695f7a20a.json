{"remainingRequest":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\IdeaProjects\\ParkingManagerVue\\src\\components\\Login.vue?vue&type=style&index=0&id=ef68022e&lang=less&scoped=true","dependencies":[{"path":"F:\\IdeaProjects\\ParkingManagerVue\\src\\components\\Login.vue","mtime":1696068494771},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1720454233855},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1720454234910},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\postcss-loader\\src\\index.js","mtime":1720454234264},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\less-loader\\dist\\cjs.js","mtime":1720454234121},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720454233480},{"path":"F:\\IdeaProjects\\ParkingManagerVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1720454234585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubG9naW5fYmcgew0KICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICB0b3A6IDA7DQogICAgbGVmdDogMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiB1cmwoIi4uLy4uL3B1YmxpYy9pbWcvYmcxLmpwZyIpIGNlbnRlciB0b3AgLyBjb3ZlciBuby1yZXBlYXQ7DQp9DQoucmVnaXN0ZXIgew0KICAgIGNvbG9yOiByZ2IoMTcyLCAxNjksIDE2OSk7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KLnJlZ2lzdGVyOmhvdmVyIHsNCiAgICBjb2xvcjogcmVkOw0KfQ0KLnJlZ2lzdGVyLWJveCB7DQogICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICAgIGhlaWdodDogNjUwcHg7DQogICAgbWFyZ2luOiAzMHB4IDIwJSAzMHB4IDIwJTsNCiAgICBwYWRkaW5nOiAyNXB4IDE1JSAyNXB4IDE1JTsNCn0NCi5yZWdpc3Rlci1ib3ggaDIgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLmxvZ2luX2JveCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDI0OCwgMjQ2LCAyNDYpOw0KICAgIHBhZGRpbmc6IDI1cHggNTBweCA1MHB4IDUwcHg7DQogICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAvLyBtYXJnaW4tdG9wOiAxMCU7DQogICAgbWFyZ2luOiAxMCUgMzglIDAgMzglOw0KICAgIG9wYWNpdHk6IDAuOTU7DQp9DQoubG9naW4tdGl0bGUgaDIgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCi50by1sb2dpbiB7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIGZvbnQtc2l6ZTogMTRweDsNCn0NCg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";AA+VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div\r\n        class=\"login_bg\"\r\n        v-loading=\"loading\"\r\n        element-loading-text=\"正在登录中,请稍等！\"\r\n        element-loading-spinner=\"el-icon-loading\"\r\n        element-loading-background=\"rgba(0, 0, 0, 0.8)\"\r\n    >\r\n        <div class=\"login_box\" v-if=\"!registerShow\">\r\n            <div class=\"login-title\">\r\n                <i style=\"font-size: 1.6vw\">登录停车场管理系统</i>\r\n            </div>\r\n            <br />\r\n            <el-form\r\n                class=\"login_form\"\r\n                :model=\"ruleForm\"\r\n                :rules=\"rules\"\r\n                ref=\"rules\"\r\n                label-width=\"0\"\r\n            >\r\n                <el-form-item prop=\"username\">\r\n                    <el-input\r\n                        v-model=\"ruleForm.username\"\r\n                        placeholder=\"请输入用户名\"\r\n                    >\r\n                        <i slot=\"prefix\" class=\"iconfont icon-r-user1\"  style=\"font-size: 24px;\"></i>\r\n                    </el-input>\r\n                </el-form-item>\r\n                <el-form-item prop=\"password\">\r\n                    <el-input\r\n                        type=\"password\"\r\n                        v-model=\"ruleForm.password\"\r\n                        placeholder=\"请输入密码\"\r\n                    >\r\n                        <i slot=\"prefix\" class=\"iconfont icon-r-lock\"  style=\"font-size: 24px;\"></i>\r\n                    </el-input>\r\n                </el-form-item>\r\n                <el-button\r\n                    type=\"primary\"\r\n                    @click=\"login\"\r\n                    style=\"width: 100%; font-size: 18px\"\r\n                >\r\n                <i class=\"iconfont icon-r-yes\" style=\"font-size: 20px;\"></i>\r\n                     登录</el-button\r\n                ><br /><br />\r\n                <el-button\r\n                    type=\"success\"\r\n                    @click=\"toRegister\"\r\n                    style=\"width: 100%; font-size: 18px\"\r\n                >\r\n                <i class=\"iconfont icon-r-add\" style=\"font-size: 20px;\"></i>\r\n\r\n                     注册</el-button\r\n                >\r\n            </el-form>\r\n        </div>\r\n        <div class=\"register-box\" v-if=\"registerShow\">\r\n            <h2>用户注册</h2>\r\n            <el-form\r\n                :model=\"registerUser\"\r\n                status-icon\r\n                :rules=\"registerRules\"\r\n                ref=\"registerRules\"\r\n                label-width=\"100px\"\r\n                class=\"demo-ruleForm\"\r\n            >\r\n                <el-form-item label=\"用户名\" prop=\"username\">\r\n                    <el-input\r\n                        v-model=\"registerUser.username\"\r\n                        placeholder=\"请输入用户名\"\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"密码\" prop=\"password\">\r\n                    <el-input\r\n                        v-model=\"registerUser.password\"\r\n                        placeholder=\"请输入密码\"\r\n                        show-password\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"确认密码\" prop=\"check\" class=\"is-required\">\r\n                    <el-input\r\n                        v-model=\"registerUser.check\"\r\n                        placeholder=\"确认密码\"\r\n                        show-password\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"姓名\" prop=\"nike\">\r\n                    <el-input\r\n                        v-model=\"registerUser.nike\"\r\n                        placeholder=\"请输入姓名\"\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"性别\" prop=\"sex\" required>\r\n                    <el-radio v-model=\"registerUser.sex\" label=\"男\"\r\n                        >男</el-radio\r\n                    >\r\n                    <el-radio v-model=\"registerUser.sex\" label=\"女\"\r\n                        >女</el-radio\r\n                    >\r\n                </el-form-item>\r\n                <el-form-item label=\"年龄\" prop=\"age\" class=\"is-required\">\r\n                    <el-input\r\n                        v-model.number=\"registerUser.age\"\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"车牌号\" prop=\"card\" class=\"is-required\">\r\n                    <el-input\r\n                        v-model=\"registerUser.card\"\r\n                        placeholder=\"请输入车牌号\"\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"联系电话\" prop=\"phone\" required>\r\n                    <el-input\r\n                        v-model=\"registerUser.phone\"\r\n                        placeholder=\"请输入联系电话\"\r\n                        style=\"width: 300px\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button\r\n                        class=\"register-btn\"\r\n                        type=\"success\" style=\"font-size: 22px;\"\r\n                        @click=\"submitForm('registerRules')\"\r\n                    ><i class=\"iconfont icon-r-add\" style=\"font-size: 24px;\"></i>\r\n                         注册</el-button\r\n                    >\r\n                    <el-button\r\n                        type=\"primary\"\r\n                        class=\"to-login\" style=\"font-size: 22px;\"\r\n                        @click=\"toLogin\"\r\n                    >\r\n                    <i class=\"iconfont icon-r-left\" style=\"font-size: 24px;\"></i>\r\n                         返回登录</el-button\r\n                    >\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nexport default {\r\n    data() {\r\n        var checkUsername = (rule, value, callback) => {\r\n            if (!value) {\r\n                return callback(new Error(\"用户名不能为空\"));\r\n            }\r\n            setTimeout(() => {\r\n                axios\r\n                    .get(\"/api/user/checkUsername?username=\" + value)\r\n                    .then((res) => {\r\n                        if (!res.data.data) {\r\n                            callback(new Error(\"用户名已存在\"));\r\n                        } else {\r\n                            callback();\r\n                        }\r\n                    });\r\n            }, 10);\r\n        };\r\n        var checkAge = (rule, value, callback) => {\r\n            if (!value) {\r\n                return callback(new Error(\"年龄不能为空\"));\r\n            }\r\n            setTimeout(() => {\r\n                if (!Number.isInteger(value)) {\r\n                    callback(new Error(\"请输入数字值\"));\r\n                } else {\r\n                    if (value < 18) {\r\n                        callback(new Error(\"必须年满18岁\"));\r\n                    } else {\r\n                        callback();\r\n                    }\r\n                }\r\n            }, 1000);\r\n        };\r\n        var validatePass2 = (rule, value, callback) => {\r\n            if (value === \"\") {\r\n                callback(new Error(\"请再次输入密码\"));\r\n            } else if (value !== this.registerUser.password) {\r\n                callback(new Error(\"两次输入密码不一致!\"));\r\n            } else {\r\n                callback();\r\n            }\r\n        };\r\n        return {\r\n            registerShow: false,\r\n            loading: false,\r\n            ruleForm: {\r\n                username: \"\",\r\n                password: \"\",\r\n            },\r\n            rules: {\r\n                username: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入用户名\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                    {\r\n                        min: 3,\r\n                        max: 10,\r\n                        message: \"长度在 3 到 10 个字符\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n                password: [\r\n                    { required: true, message: \"请输入密码\", trigger: \"blur\" },\r\n                    {\r\n                        min: 6,\r\n                        max: 15,\r\n                        message: \"长度在 6 到 15 个字符\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n            },\r\n            registerUser: {\r\n                username: \"\",\r\n                password: \"\",\r\n                check: \"\",\r\n                sex: \"男\",\r\n                phone: \"\",\r\n                age: \"\",\r\n                card: \"\",\r\n                nike: \"\",\r\n            },\r\n            registerRules: {\r\n                username: [{ validator: checkUsername, trigger: \"blur\" }],\r\n                password: [\r\n                    { required: true, message: \"请输入密码\", trigger: \"blur\" },\r\n                    {\r\n                        min: 6,\r\n                        max: 15,\r\n                        message: \"长度在 6 到 15 个字符\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n                check: [{ validator: validatePass2, trigger: \"blur\" }],\r\n                age: [{ validator: checkAge, trigger: \"blur\" }],\r\n                phone: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入联系电话\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n                card: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入车牌号\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n                nike: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入姓名\",\r\n                        trigger: \"blur\",\r\n                    },\r\n                ],\r\n            },\r\n        };\r\n    },\r\n    methods: {\r\n        login() {\r\n            this.loading = true;\r\n            axios\r\n                .post(\"/api/user/login\", this.ruleForm)\r\n                .then((res) => {\r\n                    this.loading = false;\r\n                    if (res.data.data.state) {\r\n                        this.$message.success(\"登陆成功！\");\r\n                        //  token只应在当前网站打开期间生效，所以将token保存在sessionStorage中\r\n                        window.sessionStorage.setItem(\r\n                            \"token\",\r\n                            res.data.data.uid\r\n                        );\r\n                        if (res.data.data.role == 0) {\r\n                            this.$router.push(\"/mane\");\r\n                        } else {\r\n                            this.$router.push(\"/conmen\");\r\n                        }\r\n                    } else {\r\n                        this.$message.error(\r\n                            \"登录失败,\" + res.data.data.msg + \"!\"\r\n                        );\r\n                    }\r\n                })\r\n                .catch((e) => {\r\n                    this.loading = false;\r\n\r\n                    console.log(e);\r\n                    if (\r\n                        e.response == undefined ||\r\n                        e.response.data == undefined\r\n                    ) {\r\n                        this.$message.error({\r\n                            showClose: true,\r\n                            message: e,\r\n                            duration: 5000,\r\n                        });\r\n                    } else {\r\n                        this.$message.error({\r\n                            showClose: true,\r\n                            message: e.response.data,\r\n                            duration: 5000,\r\n                        });\r\n                    }\r\n                });\r\n        },\r\n        toRegister() {\r\n            this.registerShow = true;\r\n        },\r\n        toLogin() {\r\n            this.registerShow = false;\r\n            this.$nextTick(() => {\r\n                this.$refs.rules.resetFields();\r\n            });\r\n        },\r\n        submitForm(formName) {\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    this.loading = true;\r\n                    axios\r\n                        .post(\"/api/user/register\", this.registerUser)\r\n                        .then((res) => {\r\n                            this.loading = false;\r\n                            if (res.data.data) {\r\n                                this.$message.success(\"注册成功！\");\r\n                                this.registerShow = false;\r\n                            } else {\r\n                                this.$message.error(\"登录失败,请重新尝试！\");\r\n                            }\r\n                        });\r\n                } else {\r\n                    return false;\r\n                }\r\n            });\r\n        },\r\n        resetForm(formName) {\r\n            this.$refs[formName].resetFields();\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.login_bg {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    height: 100%;\r\n    background: url(\"../../public/img/bg1.jpg\") center top / cover no-repeat;\r\n}\r\n.register {\r\n    color: rgb(172, 169, 169);\r\n    cursor: pointer;\r\n}\r\n.register:hover {\r\n    color: red;\r\n}\r\n.register-box {\r\n    background: #fff;\r\n    border-radius: 10px;\r\n    height: 650px;\r\n    margin: 30px 20% 30px 20%;\r\n    padding: 25px 15% 25px 15%;\r\n}\r\n.register-box h2 {\r\n    text-align: center;\r\n}\r\n\r\n.login_box {\r\n    background-color: rgb(248, 246, 246);\r\n    padding: 25px 50px 50px 50px;\r\n    border-radius: 10px;\r\n    // margin-top: 10%;\r\n    margin: 10% 38% 0 38%;\r\n    opacity: 0.95;\r\n}\r\n.login-title h2 {\r\n    text-align: center;\r\n}\r\n.to-login {\r\n    cursor: pointer;\r\n    font-size: 14px;\r\n}\r\n</style>"]}]}